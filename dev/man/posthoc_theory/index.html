<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Post-Hoc Analysis Guide · HypothesisTestsExtra.jl</title><meta name="title" content="Post-Hoc Analysis Guide · HypothesisTestsExtra.jl"/><meta property="og:title" content="Post-Hoc Analysis Guide · HypothesisTestsExtra.jl"/><meta property="twitter:title" content="Post-Hoc Analysis Guide · HypothesisTestsExtra.jl"/><meta name="description" content="Documentation for HypothesisTestsExtra.jl."/><meta property="og:description" content="Documentation for HypothesisTestsExtra.jl."/><meta property="twitter:description" content="Documentation for HypothesisTestsExtra.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../welch_fisher/">Welch ANOVA &amp; Fisher RxC</a></li><li class="is-active"><a class="tocitem" href>Post-Hoc Analysis Guide</a><ul class="internal"><li><a class="tocitem" href="#1.-Parametric-Post-Hoc-Tests"><span>1. Parametric Post-Hoc Tests</span></a></li><li><a class="tocitem" href="#2.-Non-Parametric-Post-Hoc-Tests"><span>2. Non-Parametric Post-Hoc Tests</span></a></li><li><a class="tocitem" href="#3.-Contingency-Table-Post-Hoc"><span>3. Contingency Table Post-Hoc</span></a></li><li><a class="tocitem" href="#Compact-Letter-Display-(CLD)"><span>Compact Letter Display (CLD)</span></a></li></ul></li><li><a class="tocitem" href="../dataframes/">DataFrame Integration</a></li></ul></li><li><a class="tocitem" href="../../lib/public/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Post-Hoc Analysis Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Post-Hoc Analysis Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/songtaogui/HypothesisTestsExtra.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/songtaogui/HypothesisTestsExtra.jl/blob/master/docs/src/man/posthoc_theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Post-Hoc-Analysis-Guide"><a class="docs-heading-anchor" href="#Post-Hoc-Analysis-Guide">Post-Hoc Analysis Guide</a><a id="Post-Hoc-Analysis-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Post-Hoc-Analysis-Guide" title="Permalink"></a></h1><p>Post-hoc tests are performed after a significant omnibus test (like ANOVA or Chi-Square) to determine <em>which</em> specific groups or categories differ. </p><h2 id="1.-Parametric-Post-Hoc-Tests"><a class="docs-heading-anchor" href="#1.-Parametric-Post-Hoc-Tests">1. Parametric Post-Hoc Tests</a><a id="1.-Parametric-Post-Hoc-Tests-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Parametric-Post-Hoc-Tests" title="Permalink"></a></h2><p><strong>Function:</strong> <code>PostHocTest</code></p><p>These methods assume normality. Choice depends on variance assumptions and the desired balance between Type I errors (False Positives) and Type II errors (False Negatives).</p><table><tr><th style="text-align: left">Method</th><th style="text-align: left">Variance Assumption</th><th style="text-align: left">Conservatism</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><strong>:tukey</strong></td><td style="text-align: left">Equal</td><td style="text-align: left">Balanced</td><td style="text-align: left"><strong>Recommended default.</strong> Controls FWER (Family-Wise Error Rate) exactly for all pairwise comparisons. Best for balanced designs.</td></tr><tr><td style="text-align: left"><strong>:bonferroni</strong></td><td style="text-align: left">Equal</td><td style="text-align: left">Very High</td><td style="text-align: left">Simple <span>$\alpha / m$</span> correction. Can be overly conservative if the number of pairs is large.</td></tr><tr><td style="text-align: left"><strong>:lsd</strong></td><td style="text-align: left">Equal</td><td style="text-align: left">Low</td><td style="text-align: left">Fisher&#39;s Least Significant Difference. No correction applied. High power but high Type I error risk. Only use if ANOVA F-test is very strong.</td></tr><tr><td style="text-align: left"><strong>:scheffe</strong></td><td style="text-align: left">Equal</td><td style="text-align: left">High</td><td style="text-align: left">Designed for <em>any</em> linear contrast, not just pairwise. Very conservative for simple pairwise tests.</td></tr><tr><td style="text-align: left"><strong>:sidak</strong></td><td style="text-align: left">Equal</td><td style="text-align: left">High</td><td style="text-align: left">Slightly more powerful version of Bonferroni.</td></tr><tr><td style="text-align: left"><strong>:tamhane</strong></td><td style="text-align: left"><strong>Unequal</strong></td><td style="text-align: left">Balanced</td><td style="text-align: left"><strong>Use after Welch ANOVA.</strong> Uses the T2 statistic and approximates degrees of freedom for every pair. Robust to heteroscedasticity.</td></tr></table><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><pre><code class="language-julia hljs"># If Levene&#39;s test failed, use Tamhane:
PostHocTest(groups; method=:tamhane)</code></pre><h2 id="2.-Non-Parametric-Post-Hoc-Tests"><a class="docs-heading-anchor" href="#2.-Non-Parametric-Post-Hoc-Tests">2. Non-Parametric Post-Hoc Tests</a><a id="2.-Non-Parametric-Post-Hoc-Tests-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Non-Parametric-Post-Hoc-Tests" title="Permalink"></a></h2><p><strong>Function:</strong> <code>PostHocNonPar</code></p><p>Used when data is ordinal or normality is violated (e.g., after Kruskal-Wallis).</p><h3 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h3><ul><li><strong>:dunn_bonferroni</strong> (Default): Uses rank sums (Z-scores) and adjusts p-values using Bonferroni.</li><li><strong>:nemenyi</strong>: The non-parametric equivalent of Tukey&#39;s HSD. Tests the difference in rank sums against a critical range from the Studentized Range distribution.</li></ul><h2 id="3.-Contingency-Table-Post-Hoc"><a class="docs-heading-anchor" href="#3.-Contingency-Table-Post-Hoc">3. Contingency Table Post-Hoc</a><a id="3.-Contingency-Table-Post-Hoc-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Contingency-Table-Post-Hoc" title="Permalink"></a></h2><p><strong>Functions:</strong> <code>PostHocContingencyRow</code>, <code>PostHocContingencyCell</code></p><p>When a Chi-Square test is significant, you need to know which rows or specific cells are driving the association.</p><h3 id="A.-Row-wise-Comparisons-(PostHocContingencyRow)"><a class="docs-heading-anchor" href="#A.-Row-wise-Comparisons-(PostHocContingencyRow)">A. Row-wise Comparisons (<code>PostHocContingencyRow</code>)</a><a id="A.-Row-wise-Comparisons-(PostHocContingencyRow)-1"></a><a class="docs-heading-anchor-permalink" href="#A.-Row-wise-Comparisons-(PostHocContingencyRow)" title="Permalink"></a></h3><p>Compares distributions between pairs of rows (groups).</p><ul><li><strong>Method <code>:chisq</code></strong>: Performs a <span>$2 \times C$</span> Chi-square test for every pair of rows.</li><li><strong>Method <code>:fisher</code></strong>: Performs a <span>$2 \times C$</span> Fisher test for every pair.</li><li><strong>Adjustment</strong>: P-values are adjusted (e.g., Bonferroni, FDR) to account for multiple testing.</li></ul><h3 id="B.-Cell-wise-Residuals-(PostHocContingencyCell)"><a class="docs-heading-anchor" href="#B.-Cell-wise-Residuals-(PostHocContingencyCell)">B. Cell-wise Residuals (<code>PostHocContingencyCell</code>)</a><a id="B.-Cell-wise-Residuals-(PostHocContingencyCell)-1"></a><a class="docs-heading-anchor-permalink" href="#B.-Cell-wise-Residuals-(PostHocContingencyCell)" title="Permalink"></a></h3><p>Identifies specific cells that are over- or under-represented.</p><ul><li><strong>Method <code>:asr</code> (Adjusted Standardized Residuals)</strong>: Calculates the residual <span>$r_{ij} = (O - E) / \sqrt{E(1-row\%)(1-col\%)}$</span>.<ul><li>If <span>$|r_{ij}| &gt; Z_{\alpha/2}$</span> (approx 1.96 for <span>$\alpha=0.05$</span>), the cell is significant.</li><li>Provides a detailed breakdown of which specific intersection (Row <span>$\times$</span> Col) deviates from independence.</li></ul></li></ul><h2 id="Compact-Letter-Display-(CLD)"><a class="docs-heading-anchor" href="#Compact-Letter-Display-(CLD)">Compact Letter Display (CLD)</a><a id="Compact-Letter-Display-(CLD)-1"></a><a class="docs-heading-anchor-permalink" href="#Compact-Letter-Display-(CLD)" title="Permalink"></a></h2><p>All group-level post-hoc tests support <code>cld=true</code>. This generates a string representation where groups sharing the same letter are <strong>not</strong> significantly different.</p><pre><code class="language-julia hljs"># 3 groups with different distributions
  g1 = rand(10)
  g2 = rand(10) .+ 2
  g3 = rand(10) .+ 0.5
  
# Perform Dunn&#39;s test with Bonferroni correction and generate CLD letters
result = PostHocNonPar([g1, g2, g3]; method=:dunn_bonferroni, cld=true, row_labels=[&quot;Ctrl&quot;, &quot;TrtA&quot;, &quot;TrtB&quot;])</code></pre><p>You will get:</p><pre><code class="language-plain hljs">------------------------------
Post-hoc Test: :dunn_bonferroni (alpha=0.05)
------------------------------

Compact Letter Display (Means sorted descending):
┌────────────┬────────────┬────────┐
│ GroupIndex │ GroupLabel │    CLD │
│      Int64 │     String │ String │
├────────────┼────────────┼────────┤
│          1 │       Ctrl │      b │
│          2 │       TrtA │      a │
│          3 │       TrtB │      b │
└────────────┴────────────┴────────┘

Pairwise Comparisons:
┌─────────────┬─────────┬─────────┬─────────┬──────────┬────────────┬───────────┬───────────┬────────┬─────────────────┐
│    Contrast │    Diff │ Std.Err │    Stat │ Critical │    P-value │ Lower 95% │ Upper 95% │    Sig │            Note │
│      String │ Float64 │ Float64 │ Float64 │  Float64 │    Float64 │   Float64 │   Float64 │ String │          String │
├─────────────┼─────────┼─────────┼─────────┼──────────┼────────────┼───────────┼───────────┼────────┼─────────────────┤
│ Ctrl - TrtA │   -19.6 │   3.937 │  4.9784 │  2.39398 │ 1.92331e-6 │  -29.0251 │  -10.1749 │      * │ Adj: Bonferroni │
│ Ctrl - TrtB │    -9.2 │   3.937 │  2.3368 │  2.39398 │  0.0583484 │  -18.6251 │  0.225108 │        │ Adj: Bonferroni │
│ TrtA - TrtB │    10.4 │   3.937 │  2.6416 │  2.39398 │  0.0247544 │  0.974892 │   19.8251 │      * │ Adj: Bonferroni │
└─────────────┴─────────┴─────────┴─────────┴──────────┴────────────┴───────────┴───────────┴────────┴─────────────────┘</code></pre><p>You can then use <code>GroupTestToDataframe</code> to get DataFrame of CLD:</p><pre><code class="language-julia hljs">julia&gt; GroupTestToDataframe(result)
3×3 DataFrame
 Row │ GroupIndex  GroupLabel  CLD    
     │ Int64       String      String 
─────┼────────────────────────────────
   1 │          1  Ctrl        b
   2 │          2  TrtA        a
   3 │          3  TrtB        b</code></pre><p>You can get the PostHoc Details use <code>DataFrame</code>:</p><pre><code class="language-julia hljs">julia&gt; DataFrame(result)
3×10 DataFrame
 Row │ Contrast     Diff     Std.Err  Stat     Critical  P-value     Lower 95%   Upper 95%   Sig     Note            
     │ String       Float64  Float64  Float64  Float64   Float64     Float64     Float64     String  String          
─────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ Ctrl - TrtA    -19.6    3.937   4.9784   2.39398  1.92331e-6  -29.0251    -10.1749    *       Adj: Bonferroni
   2 │ Ctrl - TrtB     -9.2    3.937   2.3368   2.39398  0.0583484   -18.6251      0.225108          Adj: Bonferroni
   3 │ TrtA - TrtB     10.4    3.937   2.6416   2.39398  0.0247544     0.974892   19.8251    *       Adj: Bonferroni</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../welch_fisher/">« Welch ANOVA &amp; Fisher RxC</a><a class="docs-footer-nextpage" href="../dataframes/">DataFrame Integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 21 January 2026 02:20">Wednesday 21 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
